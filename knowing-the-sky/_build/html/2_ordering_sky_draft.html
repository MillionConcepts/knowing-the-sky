

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Lesson 2: Ordering the Sky &#8212; Knowing the Sky</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2_ordering_sky_draft';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Lesson 1: Gathering the Sky" href="1_gathering_sky_draft.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Knowing the Sky - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Knowing the Sky - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_gathering_sky_draft.html">Lesson 1: Gathering the Sky</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lesson 2: Ordering the Sky</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/millionconcepts/knowing-the-sky" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/millionconcepts/knowing-the-sky/issues/new?title=Issue%20on%20page%20%2F2_ordering_sky_draft.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/2_ordering_sky_draft.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lesson 2: Ordering the Sky</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Lesson 2: Ordering the Sky</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays">Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-an-array">What is an array?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-work-with-arrays-in-python">How do you work with arrays in Python?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-images">Loading images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-arrays">Exploring arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-nonfinite-values">Dealing with nonfinite values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-arrays">Summarizing arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outside-of-numpy">Outside of numpy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-arrays">Visualizing arrays</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tables">Tables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ok-but-what-is-a-table-really">Ok, but what is a table, really?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabular-file-formats">Tabular file formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broad-categories-binary-vs-text">Broad categories: binary vs. text</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#characteristics-of-some-specific-formats">Characteristics of some specific formats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-tables-in-python">Working with tables in Python</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="lesson-2-ordering-the-sky">
<h1>Lesson 2: Ordering the Sky<a class="headerlink" href="#lesson-2-ordering-the-sky" title="Permalink to this heading">#</a></h1>
<section id="learning-objectives">
<h2>Learning Objectives:<a class="headerlink" href="#learning-objectives" title="Permalink to this heading">#</a></h2>
<p>After completing this lesson, users will be able to:</p>
<ol class="arabic simple">
<li><p>Describe array and table data types and their uses</p></li>
<li><p>Utilize python packages to open array and table data as represented by the data providers</p></li>
<li><p>Index and manipulate data within arrays and tables</p></li>
</ol>
<p><em>Python libraries introduced in this lesson:</em> astropy.io.fits, matplotlib, numpy, os, pathlib, astroquery, requests, gzip, io, tarfile</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python Standard Library imports</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># third-party imports</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>In our last lesson, we aquired data from online NASA repositories to begin an investigation to identify which stars were being referred to by the Salish individual(s) interviewed by Claude Schaffer:</p>
<blockquote>
<div><p>There was a group of three stars that rose from the place that was between the sun and the moon and it never changed its positon of rising.</p>
</div></blockquote>
<p>In this lesson, we’ll learn how to read that data into python standard objects and the basics of how to work with them. The two main types of data we’ll cover in this lesson are arrays and tables.</p>
</section>
<section id="arrays">
<h2>Arrays<a class="headerlink" href="#arrays" title="Permalink to this heading">#</a></h2>
<p>Arrays are one of the most important data structures in scientific programming, and, for that matter, practical mathematics more generally – they are a basic pattern used in many systems and cultures. Computers are very good at working with them, so knowing how to manipulate them effectively is extremely powerful. If you are reading this, it is entirely possible you have extensive experience with array data. Things may be different in Python than other languages, though, so we recommend not skipping it.</p>
<section id="what-is-an-array">
<h3>What is an array?<a class="headerlink" href="#what-is-an-array" title="Permalink to this heading">#</a></h3>
<p>Basically, an array is simply a regular grid of ‘elements’, which are often but not always numbers. It can be 1-D, 2-D, 3-D, or even more. A 1-D array is a lot like a list.</p>
<p>You can access elements in an array by coordinates, which means that they work like coordinate spaces. This is <em>very</em> useful for scientific programming. You can also perform mathematical operations on an entire array at once, which is both convenient and typically much faster than performing the same operations on each element one-by-one.</p>
<p>(footnote for the mathematically inclined): an array is <em>not</em> a vector, matrix, or tensor, but it can be used to <em>represent</em> a vector, matrix, or tensor.</p>
</section>
<section id="how-do-you-work-with-arrays-in-python">
<h3>How do you work with arrays in Python?<a class="headerlink" href="#how-do-you-work-with-arrays-in-python" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> is the most common library for creating and manipulating arrays. Most scientific programs use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> at some point, partly because many other libraries use it ‘under the hood’. A very important point is that raster images (images made up of pixels, as opposed to vector images) can always be converted to and from arrays, which means that arrays let you do very powerful image manipulation. Let’s start with a very quick introduction to the most important parts of the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library.</p>
<p>First, let’s make a little 4x4 triangular array we can play with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tri</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">triangle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0., 0.],
       [1., 1., 0., 0.],
       [1., 1., 1., 0.],
       [1., 1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<p>You can access single elements of an array by entering their coordinates in slice <code class="docutils literal notranslate"><span class="pre">[]</span></code> notation – much
like a Python list but with possible extra dimensions.</p>
<p>A reminder that python is “zero-indexed” meaning when you are counting elements in an array, list, etc. You start from 0 not 1. (This is one of the major differences between Python and MatLab!)</p>
<p>For a 2-D array, the row (y-axis) always goes first, then the column (x-axis). You get exactly the elements you specify, which means that yif you don’t enter a number for every dimension, you can pick more than one element at a time. For instance, <code class="docutils literal notranslate"><span class="pre">[0]</span></code> means “all the elements with 0-coordinate on the y-axis”, or, in other words, the first row. <code class="docutils literal notranslate"><span class="pre">[:,0]</span></code> (<code class="docutils literal notranslate"><span class="pre">:</span></code> is numpy’s placeholder) means “all the elements with 0-coordinate on the x-axis”, and returns the first column. If you specify a number for every dimension you can get just a single elements: <code class="docutils literal notranslate"><span class="pre">[0,0]</span></code> means “the number
in the upper-left corner”.</p>
<p>Let’s test this in action:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">triangle</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([1., 0., 0., 0.]), array([1., 1., 1., 1.]), 1.0)
</pre></div>
</div>
</div>
</div>
<p>You can also specify ranges. For instance, <code class="docutils literal notranslate"><span class="pre">[0:2,</span> <span class="pre">0:2]</span></code> means “give me the square in the upper left corner of size (2,2)”.</p>
<p>Note here that the range is exclusive of the final index you’re entering. In other words, you’ll get rows/columns indexed 0-1, not data from row/column 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [1., 1.]])
</pre></div>
</div>
</div>
</div>
<p>When working with arrays you read in from data, you won’t always know what shape it is because you won’t have made it like we did above. In numpy, <code class="docutils literal notranslate"><span class="pre">shape</span></code> can be used to return how many elements an array has along each of its dimensions. It’s important to know an array’s shape for a variety of reasons, but on eo fhtem is to know exactly how much there is to slice. Let’s return our array’s shape:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4, 4)
</pre></div>
</div>
</div>
</div>
<p>Remember that Python is 0-indexed, and that <code class="docutils literal notranslate"><span class="pre">.shape</span></code> returns the <em>number of elements</em>, not the index. That means this will throw an error:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">IndexError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

<span class="ne">IndexError</span>: index 4 is out of bounds for axis 0 with size 4
</pre></div>
</div>
</div>
</div>
<p>Slice notation can also be used to set elements. If you do the same things we’ve been doing, but add an assignment (<code class="docutils literal notranslate"><span class="pre">=</span></code>), you can set all the values to a number – or even set to the contents of another array, if it’s the right size.</p>
<p>This will set all the elements of the first row to 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">triangle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2., 2., 2., 2.],
       [1., 1., 0., 0.],
       [1., 1., 1., 0.],
       [1., 1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<p>If you do an arithmetic operation on an array with a scalar (like a single number), it will apply that operation to ever element of the array. Unlike slice assignment, this does not modify the array in place unless you use a special operator. It retuns a copy, leaving the original array unchanged.</p>
<p>For instance, to get a copy of the array with every element doubled:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="o">=</span> <span class="n">triangle</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">double</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4., 4., 4., 4.],
       [2., 2., 0., 0.],
       [2., 2., 2., 0.],
       [2., 2., 2., 2.]])
</pre></div>
</div>
</div>
</div>
<p>Doing arithmetic using two array perfoms the operation elementwise – elements with matching indexes from each array. Let’s create a random array to test this with. We’ll use <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randint.html"><code class="docutils literal notranslate"><span class="pre">np.random.randint</span></code></a> to create an array of random whole numbers between 0-10 the same shape as triangle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">randarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">triangle</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">randarray</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[7, 7, 2, 5],
       [5, 9, 3, 5],
       [9, 8, 5, 7],
       [2, 6, 8, 3]])
</pre></div>
</div>
</div>
</div>
<p>and then multipy it by triangle…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">randarray</span> <span class="o">*</span> <span class="n">triangle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[14., 14.,  4., 10.],
       [ 5.,  9.,  0.,  0.],
       [ 9.,  8.,  5.,  0.],
       [ 2.,  6.,  8.,  3.]])
</pre></div>
</div>
</div>
</div>
<p>This doesn’t work if you try to multiply two arrays with mis-matched shapes! Let’s test this by trying to multipy a 3 x 3 array of 3 by triangle:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">three</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[3, 3, 3],
       [3, 3, 3],
       [3, 3, 3]])
</pre></div>
</div>
</div>
</div>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three</span> <span class="o">*</span> <span class="n">triangle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">three</span> <span class="o">*</span> <span class="n">triangle</span>

<span class="ne">ValueError</span>: operands could not be broadcast together with shapes (3,3) (4,4) 
</pre></div>
</div>
</div>
</div>
<p>As expected, we get an error. But if we slice our larger array to be the same shape as our 3x3 array we can multiply them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">three</span> <span class="o">*</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6., 6., 6.],
       [3., 3., 0.],
       [3., 3., 3.]])
</pre></div>
</div>
</div>
</div>
<p>You can even do assignment like this! This will multiply the upper-left 3x3 square of <code class="docutils literal notranslate"><span class="pre">triangle</span></code> by <code class="docutils literal notranslate"><span class="pre">three</span></code>, in place:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">three</span> <span class="o">*</span> <span class="n">triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">triangle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6., 6., 6., 2.],
       [3., 3., 0., 0.],
       [3., 3., 3., 0.],
       [1., 1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Finally, you can also slice an array <em>with</em> another array. This can get complicated fast: <code class="docutils literal notranslate"><span class="pre">numpy</span></code> calls it “fancy indexing” for a reason. However, there are a lot of very simple ways to use it. This most common one is to just select all the elements of an array tha tmeet some condition. For instance, this means “pick all the elements of triangle that are less than 3”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangle</span><span class="p">[</span><span class="n">triangle</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 0., 0., 0., 1., 1., 1., 1.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="loading-images">
<h2>Loading images<a class="headerlink" href="#loading-images" title="Permalink to this heading">#</a></h2>
<p>Ok, intro examples over; let’s take a look at something more practical. We’ll load a FITS image into memory using <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> and look at some basic ways to use it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: placeholder image</span>

<span class="c1"># FITS files consist of multiple header-data units, or HDUs. Each HDU</span>
<span class="c1"># includes a header area containing metadata and a data area containing,</span>
<span class="c1"># unsurprisingly, data. This data can be an array or a table. In this case,</span>
<span class="c1"># all HDUs are arrays. astropy.io.fits loads FITS files into an HDUList</span>
<span class="c1"># object, which in most cases can simply be treated as a Python list with</span>
<span class="c1"># some extra useful methods, like .info().</span>
<span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;placeholder_images/e23456-nd-t0060-b00-f0008-r.fits&#39;</span><span class="p">)</span>
<span class="n">hdul</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">9</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># TODO: placeholder image</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># FITS files consist of multiple header-data units, or HDUs. Each HDU</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1"># object, which in most cases can simply be treated as a Python list with</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># some extra useful methods, like .info().</span>
<span class="ne">----&gt; </span><span class="mi">9</span> <span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;placeholder_images/e23456-nd-t0060-b00-f0008-r.fits&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">hdul</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="nn">File ~/mambaforge/envs/topst/lib/python3.10/site-packages/astropy/io/fits/hdu/hdulist.py:213,</span> in <span class="ni">fitsopen</span><span class="nt">(name, mode, memmap, save_backup, cache, lazy_load_hdus, ignore_missing_simple, use_fsspec, fsspec_kwargs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empty filename: </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">213</span> <span class="k">return</span> <span class="n">HDUList</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">214</span>     <span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>     <span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span>     <span class="n">save_backup</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>     <span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="n">lazy_load_hdus</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="n">ignore_missing_simple</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>     <span class="n">use_fsspec</span><span class="o">=</span><span class="n">use_fsspec</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="n">fsspec_kwargs</span><span class="o">=</span><span class="n">fsspec_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="p">)</span>

<span class="nn">File ~/mambaforge/envs/topst/lib/python3.10/site-packages/astropy/io/fits/hdu/hdulist.py:476,</span> in <span class="ni">HDUList.fromfile</span><span class="nt">(cls, fileobj, mode, memmap, save_backup, cache, lazy_load_hdus, ignore_missing_simple, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span> <span class="nd">@classmethod</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span> <span class="k">def</span> <span class="nf">fromfile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="bp">cls</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">468</span> <span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">469</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">470</span><span class="sd">     Creates an `HDUList` instance from a file-like object.</span>
<span class="g g-Whitespace">    </span><span class="mi">471</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">474</span><span class="sd">     documentation for details of the parameters accepted by this method).</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">476</span>     <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_readfrom</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">477</span>         <span class="n">fileobj</span><span class="o">=</span><span class="n">fileobj</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">479</span>         <span class="n">memmap</span><span class="o">=</span><span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span>         <span class="n">save_backup</span><span class="o">=</span><span class="n">save_backup</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">481</span>         <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">482</span>         <span class="n">ignore_missing_simple</span><span class="o">=</span><span class="n">ignore_missing_simple</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span>         <span class="n">lazy_load_hdus</span><span class="o">=</span><span class="n">lazy_load_hdus</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">484</span>         <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span>     <span class="p">)</span>

<span class="nn">File ~/mambaforge/envs/topst/lib/python3.10/site-packages/astropy/io/fits/hdu/hdulist.py:1146,</span> in <span class="ni">HDUList._readfrom</span><span class="nt">(cls, fileobj, data, mode, memmap, cache, lazy_load_hdus, ignore_missing_simple, use_fsspec, fsspec_kwargs, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1143</span> <span class="k">if</span> <span class="n">fileobj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1144</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">_File</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1145</span>         <span class="c1"># instantiate a FITS file object (ffo)</span>
<span class="ne">-&gt; </span><span class="mi">1146</span>         <span class="n">fileobj</span> <span class="o">=</span> <span class="n">_File</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1147</span>             <span class="n">fileobj</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1148</span>             <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1149</span>             <span class="n">memmap</span><span class="o">=</span><span class="n">memmap</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1150</span>             <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1151</span>             <span class="n">use_fsspec</span><span class="o">=</span><span class="n">use_fsspec</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1152</span>             <span class="n">fsspec_kwargs</span><span class="o">=</span><span class="n">fsspec_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1153</span>         <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1154</span>     <span class="c1"># The Astropy mode is determined by the _File initializer if the</span>
<span class="g g-Whitespace">   </span><span class="mi">1155</span>     <span class="c1"># supplied mode was None</span>
<span class="g g-Whitespace">   </span><span class="mi">1156</span>     <span class="n">mode</span> <span class="o">=</span> <span class="n">fileobj</span><span class="o">.</span><span class="n">mode</span>

<span class="nn">File ~/mambaforge/envs/topst/lib/python3.10/site-packages/astropy/io/fits/file.py:217,</span> in <span class="ni">_File.__init__</span><span class="nt">(self, fileobj, mode, memmap, overwrite, cache, use_fsspec, fsspec_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">215</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_fileobj</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
<span class="ne">--&gt; </span><span class="mi">217</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_filename</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_open_filelike</span><span class="p">(</span><span class="n">fileobj</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>

<span class="nn">File ~/mambaforge/envs/topst/lib/python3.10/site-packages/astropy/io/fits/file.py:626,</span> in <span class="ni">_File._open_filename</span><span class="nt">(self, filename, mode, overwrite)</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">625</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_read_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">magic</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="n">ext</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">626</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">IO_FITS_MODES</span><span class="p">[</span><span class="n">mode</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">627</span>     <span class="bp">self</span><span class="o">.</span><span class="n">close_on_error</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">629</span> <span class="c1"># Make certain we&#39;re back at the beginning of the file</span>
<span class="g g-Whitespace">    </span><span class="mi">630</span> <span class="c1"># BZ2File does not support seek when the file is open for writing, but</span>
<span class="g g-Whitespace">    </span><span class="mi">631</span> <span class="c1"># when opening a file for write, bz2.BZ2File always truncates anyway.</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;placeholder_images/e23456-nd-t0060-b00-f0008-r.fits&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As you can see from the () dimensions entry, HDU 0 contains no actual</span>
<span class="c1"># data -- it&#39;s a placeholder to help organize the rest of the file.</span>
<span class="c1"># HDU 1, however, contains an actual array. Let&#39;s go ahead and get the</span>
<span class="c1"># data from it:</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span>
<span class="n">image</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploring-arrays">
<h2>Exploring arrays<a class="headerlink" href="#exploring-arrays" title="Permalink to this heading">#</a></h2>
<p>As we saw earlier, the representation <code class="docutils literal notranslate"><span class="pre">numpy</span></code> provides for arrays is excellent for small arrays. Unfortunately, as we can see here, for large arrays, it doesn’t really tell you much except the data type <strong>todo: should we have a section on data types?</strong> and what’s in the corners. Fortunately, Python offers many tools for summarizing and visualizing arrays.</p>
<section id="dealing-with-nonfinite-values">
<h3>Dealing with nonfinite values<a class="headerlink" href="#dealing-with-nonfinite-values" title="Permalink to this heading">#</a></h3>
<p>Before we start exploring, we need to deal with the fact that lots of scientific data – including this image – contain ‘nonfinite’ values: <code class="docutils literal notranslate"><span class="pre">nan</span></code> (not-a-number, sometimes called ‘null’, used for missing or invalid entries), <code class="docutils literal notranslate"><span class="pre">inf</span></code> (infinity), and <code class="docutils literal notranslate"><span class="pre">-inf</span></code> (negative infinity). This means many statistical tools will fail on them out of the box: what, after all, is the mean of 2, 3, and not-a-number? There are several ways to work with data despite nonfinite values. The most powerful tool <code class="docutils literal notranslate"><span class="pre">numpy</span></code> provides is the masked array, which allows you to ignore specific elements and work with the array just like you would otherwise. A caveat: not all libraries ‘respect’ masked arrays, so you may have to do fancier tricks when working with some tools. However, many do. We’ll show a common trick for dealing with libraries that don’t a little further down.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># np.mean does not provide a useful result on the original array:</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># however, if we construct an array that masks all nonfinite elements, we&#39;re in business:</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s go ahead and also mask everything below 0 (0 is valid minimum for this image).</span>
<span class="c1"># the mask is just an array of boolean (True/False) values, and you can slice and assign</span>
<span class="c1"># it just like any other array. we&#39;ll use the fancy indexing trick from above:</span>
<span class="n">image</span><span class="o">.</span><span class="n">mask</span><span class="p">[</span><span class="n">image</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="summarizing-arrays">
<h3>Summarizing arrays<a class="headerlink" href="#summarizing-arrays" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> offers many built-in tools that are good for simply describing arrays as well as performing mathematical operations. Commonly-useful ones include <code class="docutils literal notranslate"><span class="pre">std</span></code> (standard deviation), <code class="docutils literal notranslate"><span class="pre">mean</span></code>, and <code class="docutils literal notranslate"><span class="pre">median</span></code>. We just looked at <code class="docutils literal notranslate"><span class="pre">mean</span></code>. Let’s look at the others.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">image</span><span class="p">),</span> 
    <span class="c1"># using the version from the np.ma namespace because of a little glitch in core numpy</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these can also be used along an individual axis. for example, if you&#39;d like the mean of every column:</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="outside-of-numpy">
<h3>Outside of numpy<a class="headerlink" href="#outside-of-numpy" title="Permalink to this heading">#</a></h3>
<p>For really serious statistical work, it’s often useful to turn to <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>, which has a wide range of useful tools. <code class="docutils literal notranslate"><span class="pre">scipy.describe</span></code> is great for getting a bunch of basic descriptive statistics at once, <em>usually</em>…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hmmm...that&#39;s a lot of nans, and it worked along only one axis, which probably isn&#39;t what </span>
<span class="c1"># we wanted. here&#39;s a little trick for getting just the unmasked elements of an array, </span>
<span class="c1"># &#39;raveled&#39; into a single dimension:</span>
<span class="n">valid</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="o">~</span><span class="n">image</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span>
<span class="n">stats</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-arrays">
<h2>Visualizing arrays<a class="headerlink" href="#visualizing-arrays" title="Permalink to this heading">#</a></h2>
<p>Since many arrays are images, we often want to simply <em>look</em> at them. This, of course, can even be useful for arrays that <em>aren’t</em> exactly images. There are many ways to do this, but the <code class="docutils literal notranslate"><span class="pre">imshow</span></code> function from <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> is one of the most straightforward: it simply plots a 1D, 2D, or 3D array on a grid. Let’s use it to take a look at the image we just opened – although the results may not be satisfying at first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unfortunately, plt.imshow, by default, applies a linear &#39;stretch&#39; to the image. Because the range</span>
<span class="c1"># of values in this image are so wide, it doesn&#39;t look like much at all -- almost everything is at the</span>
<span class="c1"># lower extreme of the color scale.</span>
<span class="c1"># let&#39;s write a little function that uses numpy to range-clip the image so we can look at it more clearly.</span>

<span class="k">def</span> <span class="nf">std_clip</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># find the mean and standard deviation of the array</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="c1"># restrict the bounds of the array to (mean - sigma * std, mean + sigma * std)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">mean</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">std</span><span class="p">)</span>

<span class="n">clipped</span> <span class="o">=</span> <span class="n">std_clip</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">clipped</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># because we made sigma variable, we can modify the stretch however we like.</span>
<span class="c1"># if we&#39;d like a brighter (but noisier) image:</span>
<span class="n">really_clipped</span> <span class="o">=</span> <span class="n">std_clip</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">really_clipped</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># slicing works very well on arrays considered as images. for instance, you can use</span>
<span class="c1"># it to take a &#39;cutout&#39; from an image to look at a portion in detail:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">clipped</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">:</span><span class="mi">1200</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="tables">
<h1>Tables<a class="headerlink" href="#tables" title="Permalink to this heading">#</a></h1>
<p>Tables are basically arrays.</p>
<section id="ok-but-what-is-a-table-really">
<h2>Ok, but what is a table, really?<a class="headerlink" href="#ok-but-what-is-a-table-really" title="Permalink to this heading">#</a></h2>
<p>A table is <em>like</em> an array, with the following differences:</p>
<ul class="simple">
<li><p>‘Table’ implies 2-D: it has rows and columns and nothing else.</p></li>
<li><p>The columns of a table are also called ‘fields’, and have
<em>meanings</em> that are distinct from one another: for instance, a table created from a radiometer
on a satellite might have fields representing time, latitude, longitude, and brightness temperature;
individual rows would represent individual observations.</p>
<ul>
<li><p>This is different from arrays, where, in general, every element has a roughly equivalent <em>meaning</em>, but in a different <em>place</em>.</p></li>
</ul>
</li>
<li><p>A table can have more than one data type: for instance, a star catalog might have a field representing
right ascension in 64-bit floating-point numbers, and a field representing star names as strings.</p></li>
<li><p><strong>todo: maybe not necessary here</strong> A table also generally has an ‘index’, which can be
a numerical series that simply corresponds to row number, but can be something else
entirely – for instance, a table of personnel data might be indexed by employee ID number.</p></li>
</ul>
<p>Like arrays, tables are of ancient origin and found in many forms in many contexts, but computers really like to work with them. Tables are even more widely used than arrays in general-purpose computing. Common examples include spreadsheets and SQL databases. The world runs on tables.</p>
</section>
<section id="tabular-file-formats">
<h2>Tabular file formats<a class="headerlink" href="#tabular-file-formats" title="Permalink to this heading">#</a></h2>
<section id="broad-categories-binary-vs-text">
<h3>Broad categories: binary vs. text<a class="headerlink" href="#broad-categories-binary-vs-text" title="Permalink to this heading">#</a></h3>
<p>Tables can be stored in many formats. The two major <em>categories</em> of format are binary and text tables. Text table formats store values as human-readable strings, like:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>RA</p></th>
<th class="head"><p>DEC</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>17.222</p></td>
<td><p>-12.301</p></td>
</tr>
<tr class="row-odd"><td><p>17.223</p></td>
<td><p>-12.311</p></td>
</tr>
<tr class="row-even"><td><p>17.222</p></td>
<td><p>-12.323</p></td>
</tr>
</tbody>
</table>
<p>These sorts of tables are relatively easy to look at and manipulate in spreadsheet programs or text editors – unless they get so big that the program will refuse to load them!</p>
<p>By contrast, binary table formats store values as raw bytes. The number of bytes per entry depends on the underlying data type. They are poorly human-readable, but tend to use less disk space and be quicker to load than text tables. As 32-bit floating point numbers expressed in bytes, the preceding table might look like:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>\xa8\xc6\x89</p></td>
<td><p>\xe5\xd0D\xc1</p></td>
</tr>
<tr class="row-odd"><td><p>\xb4\xc8\x89A</p></td>
<td><p>\xe5\xd0D\xc1</p></td>
</tr>
<tr class="row-even"><td><p>\xa8\xc6\x89</p></td>
<td><p>\x02+E\xc1</p></td>
</tr>
</tbody>
</table>
<p>This is about 50% smaller in terms of data volume than the text version, but most people are not going to get much out of just <em>looking</em> at it, and trying to manipulate it by copy-pasting would be fruitless. To use it, you need to load it into software that will translate it into meaningful numbers.</p>
<p>Some binary table formats simply contain encoded values. Other formats embed metadata along with the values (for instance, cell colors in an Excel file). These formats tend to be harder to read.</p>
<p>The upshot of all this is that really large tables – tables that you wouldn’t be able to visually scan, or maybe even successfully load, in a spreadsheet or text editor – should almost always be stored in binary formats. Small tables are fine to store as text. If you’re only planning to use them as intermediate data, though, small tables might also just as well be binary.</p>
</section>
<section id="characteristics-of-some-specific-formats">
<h3>Characteristics of some specific formats<a class="headerlink" href="#characteristics-of-some-specific-formats" title="Permalink to this heading">#</a></h3>
<p>There are many, many tabular data formats. This is not an exhaustive list, but here are some common formats you are likely to encounter in planetary science and astronomy:</p>
<p><strong>DSV (delimiter-separated value)</strong></p>
<p>DSV is a family of text table formats that place each row on a separate line, and separates columns with a special delimiter character, usually a comma or a tab (a tab is represented by ‘\t’ in most programming languages). Comma-separated tables are often called CSV, and tab-separated TSV. This is a CSV table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">satellite</span><span class="p">,</span><span class="mf">1.002</span><span class="p">,</span><span class="o">-</span><span class="mi">379</span><span class="p">,</span><span class="kc">True</span>
<span class="n">unknown</span><span class="p">,</span><span class="mf">1.547</span><span class="p">,</span><span class="o">-</span><span class="mi">22</span><span class="p">,</span><span class="kc">False</span>
</pre></div>
</div>
<p>Common file extensions for DSV files are .csv, .tsv, .txt, and .tab, but there are many others.</p>
<p><strong>FWF (fixed-width file)</strong></p>
<p>FWF is a text table format that places each row on a separate line, and separates columns by defining a specific ‘width’ – number of characters – for each column. These columns may also have whitespace ‘padding’ to make them easier to read (and for programs to figure out how to parse them if they don’t have the definition available). FWF files were traditionally easier for programs to read than DSV files, but this is no longer true. In general, we recommend choosing DSV formats over FWF, because the delimiters make it easier for a wider variety of programs to parse them, they are usually a little smaller (because not every row has to be the same width), and you are less likely to make mistakes if you edit them manually. This is a fixed-width version of the DSV table above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">satellite</span> <span class="mf">1.002</span> <span class="o">-</span><span class="mi">379</span> <span class="kc">True</span> 
<span class="n">unknown</span>   <span class="mf">1.547</span> <span class="o">-</span><span class="mi">22</span>  <span class="kc">False</span>
</pre></div>
</div>
<p>.tab and .txt are common file extensions for FWF, but, like DSV, providers often exercise creativity.</p>
<p><strong>Excel (and other spreadsheet formats)</strong></p>
<p>Spreadsheet files are generally binary tables with embedded metadata that allow spreadsheet programs to retain formatting like fonts, cell colors, and sheet breaks. These are usually <em>proprietary</em> formats: although they can be reverse-engineered, the makers of the software do not publish specifications for them, and they are subject to change between software versions. This means that they are poorly portable and not very future-proof. For these reasons, we do not recommend exchanging scientific data in spreadsheet formats, and most spreadsheet software can easily export data in standard formats like CSV. Most spreadsheet formats have extensions that indicate the specific software used to produce them: for instance, Excel uses .xlsx or .xls.</p>
<p><strong>FITS</strong></p>
<p>FITS files, which were invented for astronomy but have seen widespread adoption in other scientific disciplines, can contain either binary or text tables (although FITS text tables are rarely used in practice). Because FITS files, as we discussed earlier, can have multiple HDUs, a single FITS file can contain multiple tables. FITS files usually have a .fits or .fit extension. We think FITS is one of the best ways to save tables due to its widespread support and mature, stable standard.</p>
<p><strong>PDS binary tables</strong></p>
<p>Many tabular data products in the PDS have ad-hoc structures they describe in external metadata. Standards differ between PDS3 and PDS4. In PDS3, structures can be defined in either their attached or detached PDS3 labels, or in an arbitrary number of distinct format (.fmt) files. In PDS4, binary table structure must be completely defined in a file’s detached XML (.xml) label. Common extensions for these files include .dat and .tab.</p>
<p><strong>SQL databases</strong></p>
<p><strong>TODO: maybe skip this?</strong></p>
<p><strong>Parquet</strong></p>
<p>Parquet is a newer tabular interchange format that has seen wide adoption in industry and is increasingly common in scientific contexts. It is a <em>columnar</em> format, which means that every field is stored in a distinct area and can be both compressed and readily accessed individually, which makes it very efficient for many purposes. We think Parquet is also an excellent choice for tabular data, especially very large tables that you don’t want to load into memory all at once.</p>
<p><strong>general-purpose data formats</strong></p>
<p>Finally, while this category is much to broad to detail, it’s worth noting that tables can also be represented in structured data formats that aren’t specialized for tables, like Javascript Object Notation (JSON) and Extended Markup Language (XML). (In fact, Excel files rely in part on a compressed and modified version of XML!) Features of programming languages that save in-memory objects to disk, like Python <code class="docutils literal notranslate"><span class="pre">pickle</span></code> files or MATLAB .mat files, can similarly be used to store tables – but then they can only be opened in that programming language! We don’t recommend doing this unless you have a really good reason to.</p>
<p><strong>TODO: maybe something about headers?</strong></p>
</section>
</section>
<section id="working-with-tables-in-python">
<h2>Working with tables in Python<a class="headerlink" href="#working-with-tables-in-python" title="Permalink to this heading">#</a></h2>
<p>There are many packages for working with tabular data in Python. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is by far the most common, and it’s what we’ll mostly use in this book. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> has built-in support for reading and writing a wide variety of table formats, but not all, so you’ll sometimes need to use a helper package to load data into <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. For instance, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> can’t read FITS tables, so you’ll need to go through a specialty FITS library like <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> or <code class="docutils literal notranslate"><span class="pre">fitsio</span></code>. Similarly, to read tables described in PDS metadata, you’ll need to use a library like <code class="docutils literal notranslate"><span class="pre">pdr</span></code> or <code class="docutils literal notranslate"><span class="pre">pds4-tools</span></code>.</p>
<p>Also, as you saw in the previous lesson, people often compress table files ‘monolithically’, wrapping the whole file at once in a compression format like gzip. Some packages can decompress files like this automatically, but most can’t, so you’ll often need to decompress table files before you can use them.</p>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> is very, very powerful; however, it has many features that don’t follow a common idiom, so it needs to be used with care. Let’s move on to some basic ways to use <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. We’ll use the Bright Star Catalog as our sample data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># the BSC &#39;catalog&#39; file has no file extension. However, if you open </span>
<span class="c1"># it up in a text editor, you&#39;ll quickly see that:</span>
<span class="c1"># 1. it is a text table, and</span>
<span class="c1"># 2. it has no delimiter characters.</span>
<span class="c1"># this means that it is a fixed-width file. </span>
<span class="c1"># you&#39;ll also notice that a lot of the fields appear to run together,</span>
<span class="c1"># which makes it somewhat hard to read -- both for humans and for</span>
<span class="c1"># pandas. let&#39;s see what happens if we just use the pandas</span>
<span class="c1"># read_fwf function, which attempts to read a FWF by inferring</span>
<span class="c1"># the width of each field. The header=None argument tells pandas</span>
<span class="c1"># that the table has no column headers.</span>

<span class="n">bsc_take_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="s1">&#39;bright_star_directory/catalog&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">bsc_take_1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ok, that looks _sort of_ reasonable. We can validate it by opening the specification of the table</span>
<span class="c1"># in bright_star_catalog/ReadMe in a text editor...</span>
<span class="c1"># And, unfortunately, if you scroll down to line 77, &quot;Byte-by-byte Description of file&quot;,</span>
<span class="c1"># you&#39;ll see that it&#39;s not correct. The specification gives over 50 columns, while pandas detected</span>
<span class="c1"># only 14:</span>
<span class="n">bsc_take_1</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># so, we have a couple of options here. If you take a look at the read_fwf() documentation here,</span>
<span class="c1"># https://pandas.pydata.org/docs/reference/api/pandas.read_fwf.html,</span>
<span class="c1"># you&#39;ll see that you can pass a list of column specifications to read_fwf() in its colspecs argument.</span>
<span class="c1"># however, we&#39;d have to type all of those in, which is doable, but doesn&#39;t sound like much fun.</span>
<span class="c1"># The easy direct download we used last time deceived us.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s, instead, try to get this into pandas another way.</span>
<span class="c1"># CNRS&#39;s Vizier service offers access to many complete catalogs. </span>
<span class="c1"># Let&#39;s see if it&#39;s got the BSC.</span>
<span class="kn">from</span> <span class="nn">astroquery.vizier</span> <span class="kn">import</span> <span class="n">Vizier</span>

<span class="n">catalogs</span> <span class="o">=</span> <span class="n">Vizier</span><span class="o">.</span><span class="n">find_catalogs</span><span class="p">(</span><span class="s1">&#39;Bright Star Catalogue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ok, it&#39;s got 19 catalogs related to that search! Let&#39;s take a look at which specific one we want:</span>
<span class="p">{</span>
    <span class="n">c</span><span class="p">:</span> <span class="n">r</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">catalogs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># looks like &#39;V/50&#39; is our target. Let&#39;s go ahead and download the whole thing from Vizier.</span>
<span class="c1"># by default, Vizier will only return 50 rows, and we want the whole table, so let&#39;s </span>
<span class="c1"># make a new Vizier object with changed settings:</span>
<span class="n">big_vizier_fetcher</span> <span class="o">=</span> <span class="n">Vizier</span><span class="p">(</span><span class="n">row_limit</span><span class="o">=</span><span class="mi">99999</span><span class="p">)</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">big_vizier_fetcher</span><span class="o">.</span><span class="n">get_catalogs</span><span class="p">([</span><span class="n">catalogs</span><span class="p">[</span><span class="s1">&#39;V/50&#39;</span><span class="p">]])</span>
<span class="n">tables</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we&#39;ve got the catalog _and_ the notes. let&#39;s look at the catalog.</span>
<span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this doesn&#39;t have quite as many columns as the &#39;full&#39; version, but they&#39;re separated correctly,</span>
<span class="c1"># and we don&#39;t need most of that metadata. </span>
<span class="c1"># you&#39;ll also note that astroquery.vizier returned this as an astropy Table object, but we&#39;d rather</span>
<span class="c1"># work with it in pandas. astropy Tables can be easily converted to pandas, so let&#39;s do that:</span>
<span class="n">bsc</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">bsc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># that&#39;s more like it! now, to prevent us from having to fetch it again,</span>
<span class="c1"># let&#39;s write it out in a format pandas will be able to understand more easily --</span>
<span class="c1"># a simple CSV file.</span>
<span class="c1"># (the index=None argument means &#39;don&#39;t write the index as a separate column&#39;.)</span>
<span class="n">bsc</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;bright_star_directory/catalog.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now let&#39;s verify that we can read it in again:</span>
<span class="n">bsc_in</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;bright_star_directory/catalog.csv&#39;</span><span class="p">)</span>
<span class="n">bsc_in</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Great. It looks the same, with one notable exception: it reinterpreted some</span>
<span class="c1"># of the columns as numbers, which also caused it to fill in blank spaces with NaNs. </span>
<span class="c1"># This is in fact a very good thing! for instance, if we&#39;d wanted to look at all the</span>
<span class="c1"># stars with Double Star Catalog designation (ADS) &lt; 50, and had tried to do that on the </span>
<span class="c1"># original table, we would have gotten an error, because Vizier specified that column</span>
<span class="c1"># as a string.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ok, so what can we do with this object?</span>
<span class="c1"># First, a little vocab: this object is called a DataFrame. </span>
<span class="c1"># This is one of the two basic pandas types. The other basic pandas type</span>
<span class="c1"># is a Series. Every field/column in a DataFrame is a Series:</span>
<span class="nb">type</span><span class="p">(</span><span class="n">bsc_in</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;RAJ2000&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># like numpy, pandas has a lot of tools for accessing elements of a table,</span>
<span class="c1"># but it works differently, principally because rows and columns can have</span>
<span class="c1"># names, not just numbers.</span>

<span class="c1"># pandas&#39;s core tools for this are called _indexers_, and it has three of them:</span>
<span class="c1"># .at, .loc, and .iloc. .at is rarely used and we will ignore it; we will mostly </span>
<span class="c1"># discuss .loc here.</span>

<span class="c1"># .loc fetches one or more elements by name: index name(s) first, column name(s) second.</span>
<span class="c1"># Like numpy, pandas uses &#39;:&#39; as a placeholder, and you don&#39;t have to give it both</span>
<span class="c1"># index and column. Some examples:</span>

<span class="c1"># this is the visual magnitude (Vmag) of stars 3000-3010:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3000</span><span class="p">:</span><span class="mi">3010</span><span class="p">,</span> <span class="s1">&#39;Vmag&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is everything in the 3000th row:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3000</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the Vmag of every star:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Vmag&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simply using slice notation right on the dataframe is an alias for .loc[:, column_name]:</span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># you&#39;ll note that these last few gave Series objects rather than DataFrame objects.</span>
<span class="c1"># this is because we only got a single row or column at once. It&#39;s possible to slice</span>
<span class="c1"># a whole dataframe out of a dataframe. Because the columns have string names rather</span>
<span class="c1"># than numbers, you can do this by passing a list. Here is the vmag and right ascension</span>
<span class="c1"># of stars 30-40, presented as a dataframe:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Vmag&#39;</span><span class="p">,</span> <span class="s1">&#39;RAJ2000&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># like numpy arrays, you can select elements of a DataFrame that meet some special condition.</span>
<span class="c1"># the easiest way to do that is by defining a logical predicate. An expression like this</span>
<span class="c1"># produces a boolean Series giving us only very bright stars with Vmag &lt; 2:</span>
<span class="n">bright_predicate</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">2</span>
<span class="n">bright_predicate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can then pass that Series to .loc in order to select all the rows</span>
<span class="c1"># of the DataFrame for which that condition is true:</span>
<span class="n">bright</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bright_predicate</span><span class="p">]</span>
<span class="n">bright</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># like arrays, the values in DataFrames can be easily plotted with matplotlib.</span>
<span class="c1"># for instance, to make a scatter plot of Vmag vs. color (B-V):</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag&#39;</span><span class="p">],</span> <span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;B-V&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># like arrays, you can assign values to particular elements of a DataFrame,</span>
<span class="c1"># and you can do operations on big swaths of a DataFrame at once.</span>
<span class="c1"># you&#39;ll note that there&#39;s some unnecessary padding in the &#39;Name&#39; field:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s trim all that using a simple regex that will truncate all sequences of more than one space. </span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  +&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unlike arrays, you can also just add new columns willy-nilly. Vmag is logarithmic in base ~2.512, so </span>
<span class="c1"># if you wanted a linear version of it for some calculation, you could do this:</span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag_exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.512</span> <span class="o">**</span> <span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag&#39;</span><span class="p">]</span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;Vmag_exp&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and we don&#39;t really want it, so let&#39;s take a look at how we can easily drop that column:</span>
<span class="n">bsc_in</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Vmag_exp&#39;</span><span class="p">)</span>
<span class="n">bsc_in</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can also drop rows. There are a few entries in the BSC that don&#39;t have actual</span>
<span class="c1"># coordinates. Let&#39;s clean them up quickly. Note that the &#39;~&#39; means &#39;not&#39;, so we&#39;re </span>
<span class="c1"># saying: &#39;get rid of all the rows that don&#39;t have a real RAJ2000 value&#39;.</span>
<span class="n">bsc_in</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">bsc</span><span class="p">[</span><span class="s1">&#39;RAJ2000&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span>
<span class="c1"># after you do this sort of thing, it&#39;s usually a good idea to copy the dataframe and reset the</span>
<span class="c1"># index -- otherwise you can get confusing errors. (There are cases where this isn&#39;t</span>
<span class="c1"># true, of course, but it&#39;s a good rule of thumb.) This is the easiest way to do it:</span>
<span class="n">bsc_in</span> <span class="o">=</span> <span class="n">bsc_in</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># there&#39;s one more thing we should do before we move on. The BSC gives RA and DEC</span>
<span class="c1"># in sexigesimal notation. This is all well and good, but can be hard for general-purpose</span>
<span class="c1"># tools to work with, because they don&#39;t usually understand this notation. Hence this error:</span>
<span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;RAJ2000&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;DEJ2000&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fortunately, astropy _does_ understand this notation, and we can use it to convert these</span>
<span class="c1"># from sexigesimal to decimal. The Angle object from astropy.coordinates is our helper here.</span>
<span class="c1"># note that you have to specify the units, or astropy will be unhappy.</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">Angle</span>
<span class="n">ra0</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">bsc_in</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;RAJ2000&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span>
<span class="c1"># astropy parses and prints it nicely:</span>
<span class="n">ra0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and then you can convert it from hour-minute-second to decimal degrees:</span>
<span class="n">ra0_decimal</span> <span class="o">=</span> <span class="n">ra0</span><span class="o">.</span><span class="n">degree</span>
<span class="n">ra0_decimal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># that&#39;s all well and good for a single value -- but you can even pass the entire</span>
<span class="c1"># Series at once...</span>
<span class="n">ra_angles</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;RAJ2000&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span>
<span class="n">ra_angles</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and convert it all to decimal at once!</span>
<span class="n">ra_decimal</span> <span class="o">=</span> <span class="n">ra_angles</span><span class="o">.</span><span class="n">degree</span>
<span class="n">ra_decimal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s do the same thing with declination, which is in degree-minute-second</span>
<span class="c1"># rather than hour-minute-second:</span>
<span class="n">dec_angle</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;DEJ2000&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">dec_angle</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dec_decimal</span> <span class="o">=</span> <span class="n">dec_angle</span><span class="o">.</span><span class="n">degree</span>
<span class="n">dec_decimal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we can go ahead and replace the ra/dec strings in the dataframe</span>
<span class="c1"># with our decimal numbers.</span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;RAJ2000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ra_decimal</span>
<span class="n">bsc_in</span><span class="p">[</span><span class="s1">&#39;DEJ2000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec_decimal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and you&#39;ll find that our earlier expression will work:</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="1_gathering_sky_draft.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lesson 1: Gathering the Sky</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Lesson 2: Ordering the Sky</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-objectives">Learning Objectives:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arrays">Arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-an-array">What is an array?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-work-with-arrays-in-python">How do you work with arrays in Python?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-images">Loading images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-arrays">Exploring arrays</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-nonfinite-values">Dealing with nonfinite values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarizing-arrays">Summarizing arrays</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outside-of-numpy">Outside of numpy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-arrays">Visualizing arrays</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tables">Tables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ok-but-what-is-a-table-really">Ok, but what is a table, really?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tabular-file-formats">Tabular file formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#broad-categories-binary-vs-text">Broad categories: binary vs. text</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#characteristics-of-some-specific-formats">Characteristics of some specific formats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-tables-in-python">Working with tables in Python</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sierra V. Brown, Michael St. Clair, Chase Million, Shandin Pete. This work is supported by NASA grant No. 80NSSC23K0866.
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>